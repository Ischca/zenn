---
title: "Claude Code実践ガイド: コンテキスト運用の基本"
emoji: "📚"
type: "tech"
topics: ["claudecode", "ai", "cli", "開発ツール"]
published: false
---

## はじめに

「コンテキストウィンドウ」という言葉、なんとなく聞いたことはあるかもしれません。
Claude Codeを使う上で、この概念を理解しておくと見通しが良くなります。
この記事では、コンテキストとは何か、なぜ管理が必要なのかを整理します。

## Claude Codeとは

Claude Codeは、Anthropicが提供するエージェント型のコーディングツールです。ターミナル上で動作し、自然言語で指示を出すとコードの読み書き、コマンドの実行、gitの操作などを自律的に行います。

[公式ドキュメント](https://code.claude.com/docs/en/overview)では次のように説明されています：

> Claude Codeはターミナルに住むエージェント型コーディングツールで、コードベースを理解し、自然言語コマンドを通じてより速くコードを書く手助けをします。

GitHub Copilotのような補完型ツールとは異なり、Claude Codeは「タスクを与えると自律的に作業を進める」という点が特徴です。ファイルを探し、読み、編集し、テストを実行し、コミットするといった一連の作業を、人間が逐一指示しなくても進めていきます。

## コンテキストウィンドウとは

Claude Codeを理解する上で最も重要な概念が「コンテキストウィンドウ」です。

[Sid Bharathのガイド](https://www.siddharthbharath.com/claude-code-the-complete-guide/)では次のように説明されています：

> Claudeと新しいチャットを始めると、CLAUDE.mdファイルがコンテキストウィンドウに読み込まれます。コンテキストウィンドウとは、レスポンス生成時にモデルが一度に考慮できるテキストの最大量（トークン数で測定）です。チャットを続けると、会話履歴がこのコンテキストウィンドウに蓄積されていきます。読み込んだファイル、生成したコード、ツールの実行結果も同様です。

つまりコンテキストウィンドウは「Claudeの作業メモリ」のようなものです。現在のClaudeモデルでは約200,000トークン（日本語で約10万字程度）が上限となっています。

この上限に近づくと「コンパクト」と呼ばれる自動圧縮が発生し、古い情報が要約・削除されます。これが「コンテキスト管理」が重要になる理由です。

## CLAUDE.mdとは

CLAUDE.mdは、プロジェクト固有の情報をClaudeに伝えるための特別なファイルです。

[Anthropicのベストプラクティス](https://www.anthropic.com/engineering/claude-code-best-practices)では次のように説明されています：

> CLAUDE.mdは、Claudeが会話を開始するときに自動的にコンテキストに取り込む特別なファイルです。これはドキュメント化に最適な場所です：
> - リポジトリのエチケット（ブランチ命名、merge vs rebaseなど）
> - 開発環境のセットアップ（pyenvの使用、どのコンパイラが動くかなど）
> - プロジェクト固有の予期しない動作や警告

[公式ブログ](https://claude.com/blog/using-claude-md-files)ではより詳しく説明されています：

> よく設定されたCLAUDE.mdは、Claudeが特定のプロジェクトで働く方法を一変させます。このファイルは複数の目的を果たします：アーキテクチャのコンテキストを提供し、ワークフローを確立し、Claudeを開発ツールに接続します。
>
> CLAUDE.mdファイルはClaudeのシステムプロンプトの一部になります。すべての会話はこのコンテキストがすでに読み込まれた状態で始まり、基本的なプロジェクト情報を繰り返し説明する必要がなくなります。

人間の新メンバーに渡す「オンボーディング資料」と同じ発想です。毎回同じ説明を繰り返す代わりに、CLAUDE.mdに書いておけば自動で読み込まれます。

## コンテキスト管理が必要な理由

コンテキストウィンドウには上限があるため、管理を怠ると以下の問題が発生します。

**情報の喪失**
コンパクトが発動すると、最初に渡した指示や制約が要約・削除されることがあります。「このファイルは触らないで」と指示していたのに、コンパクト後に忘れられてしまう、といった事態が起きえます。

**パフォーマンスの低下**
CLAUDE.mdに情報を詰め込みすぎると、モデルが従える指示数の上限に近づきます。[HumanLayerの分析](https://www.humanlayer.dev/blog/writing-a-good-claude-md)によると、Claude Codeのシステムプロンプトには既に約50の指示が含まれており、モデルが確実に従える指示数は150〜200程度とされています。

## CLAUDE.mdの作成

### /initで自動生成する

[Builder.ioのガイド](https://www.builder.io/blog/claude-md-guide)では次のように述べられています：

> 始める最も速い方法は/initコマンドです。プロジェクトディレクトリで実行すると、Claudeがプロジェクト構造と検出された技術スタックに基づいてスターターのCLAUDE.mdを生成します。

`/init`を実行すると、以下のような情報が自動検出されます：
- 技術スタック（package.json、go.mod等から）
- ディレクトリ構成
- 既存の設定ファイル

### 追記すべき内容

自動生成された内容に、以下を追記します：
- チーム固有のコーディング規約
- 触ってはいけないファイル・ディレクトリ
- よく使うコマンド
- PRでよくある指摘事項

特に「PRでよくある指摘事項」は重要です。暗黙知になっているルールを言語化する良い機会になります。

### 肥大化を防ぐ

[公式ブログ](https://claude.com/blog/using-claude-md-files)では次のように推奨されています：

> 必須のフォーマットはありません。簡潔で人間が読みやすく保ち、人間とClaudeの両方がすぐに理解できるドキュメントとして扱うことを推奨します。

CLAUDE.mdは500行以下を目安にします。詳細な仕様は別ファイルに分け、必要なときだけ参照させる形が望ましいです。

## コンパクト問題への対策

コンテキスト消費を抑えるには、セッションの設計を見直します。

**Planモードを活用する**
Planモード（後の記事で詳述）では読み取り中心の動作になり、コンテキスト消費が比較的少なくなります。

**Tasksで作業を分割する**
長時間の作業はTasksを使って分割します。タスク単位でセッションを区切ることで、1セッションあたりのコンテキスト消費を抑えられます。

**`/clear`を活用する**
新しい作業を始めるときは`/clear`で会話履歴をリセットします。

## まとめ

- Claude Codeはエージェント型のコーディングツールで、自律的にタスクを実行する
- コンテキストウィンドウはClaudeの作業メモリであり、上限がある
- CLAUDE.mdは毎セッション自動で読み込まれる設定ファイル
- コンテキスト管理を怠ると、情報喪失やパフォーマンス低下が起きる
- `/init`で自動生成し、チーム固有のルールを追記する
